require("../env");var vows=require("vows"),assert=require("assert"),suite=vows.describe("selection.datum");suite.addBatch({"select(body)":{topic:function(){return d3.select("body").html("")},"updates the data according to the specified function":function(e){e.data([42]).datum(function(e,t){return e+t}),assert.equal(document.body.__data__,42)},"updates the data to the specified constant":function(e){e.datum(43),assert.equal(document.body.__data__,43)},"deletes the data if the function returns null":function(e){e.data([42]).datum(function(){return null}),assert.isFalse("__data__"in document.body)},"deletes the data if the constant is null":function(e){e.data([42]).datum(null),assert.isFalse("__data__"in document.body)},"returns the current selection":function(e){assert.isTrue(e.datum(function(){return 1})===e),assert.isTrue(e.datum(2)===e)},"with no arguments, returns the first node's datum":function(e){e.data([42]),assert.equal(e.datum(),42)}}}),suite.addBatch({"selectAll(div)":{topic:function(){return d3.select("body").html("").selectAll("div").data(d3.range(2)).enter().append("div")},"updates the data according to the specified function":function(e){e.data([42,43]).datum(function(e,t){return e+t}),assert.equal(e[0][0].__data__,42),assert.equal(e[0][1].__data__,44)},"updates the data to the specified constant":function(e){e.datum(44),assert.equal(e[0][0].__data__,44),assert.equal(e[0][1].__data__,44)},"deletes the data if the function returns null":function(e){e.datum(function(){return null}),assert.isFalse("__data__"in e[0][0]),assert.isFalse("__data__"in e[0][1])},"deletes the data if the constant is null":function(e){e.datum(null),assert.isFalse("__data__"in e[0][0]),assert.isFalse("__data__"in e[0][1])},"returns the current selection":function(e){assert.isTrue(e.datum(function(){return 1})===e),assert.isTrue(e.datum(2)===e)},"ignores null nodes":function(e){var t=d3.selectAll("div").data([42,43]);t[0][1]=null,t.datum(function(){return 1}),assert.equal(e[0][0].__data__,1),assert.equal(e[0][1].__data__,43),t.datum(2),assert.equal(e[0][0].__data__,2),assert.equal(e[0][1].__data__,43)}}}),suite.export(module)