function ascendingByKey(e,t){return d3.ascending(e.key,t.key)}require("../env");var vows=require("vows"),assert=require("assert"),suite=vows.describe("d3.map");suite.addBatch({constructor:{"map() returns an empty map":function(){var e=d3.map();assert.deepEqual(e.keys(),[])},"map(null) returns an empty map":function(){var e=d3.map(null);assert.deepEqual(e.keys(),[])},"map(object) copies enumerable keys":function(){var e=d3.map({foo:42});assert.isTrue(e.has("foo")),assert.equal(e.get("foo"),42);var e=d3.map(Object.create(null,{foo:{value:42,enumerable:!0}}));assert.isTrue(e.has("foo")),assert.equal(e.get("foo"),42)},"map(object) copies inherited keys":function(){function e(){}e.prototype.foo=42;var t=d3.map(Object.create({foo:42}));assert.isTrue(t.has("foo")),assert.equal(t.get("foo"),42);var t=d3.map(new e);assert.isTrue(t.has("foo")),assert.equal(t.get("foo"),42)},"map(object) does not copy non-enumerable keys":function(){var e=d3.map({__proto__:42});assert.isFalse(e.has("__proto__")),assert.isUndefined(e.get("__proto__"));var e=d3.map(Object.create(null,{foo:{value:42,enumerable:!1}}));assert.isFalse(e.has("foo")),assert.isUndefined(e.get("foo"))}},forEach:{"empty maps have an empty keys array":function(){var e=d3.map();assert.deepEqual(e.entries(),[]),e.set("foo","bar"),assert.deepEqual(e.entries(),[{key:"foo",value:"bar"}]),e.remove("foo"),assert.deepEqual(e.entries(),[])},"keys are returned in arbitrary order":function(){var e=d3.map({foo:1,bar:"42"});assert.deepEqual(e.entries().sort(ascendingByKey),[{key:"bar",value:"42"},{key:"foo",value:1}]);var e=d3.map({bar:"42",foo:1});assert.deepEqual(e.entries().sort(ascendingByKey),[{key:"bar",value:"42"},{key:"foo",value:1}])},"observes changes via set and remove":function(){var e=d3.map({foo:1,bar:"42"});assert.deepEqual(e.entries().sort(ascendingByKey),[{key:"bar",value:"42"},{key:"foo",value:1}]),e.remove("foo"),assert.deepEqual(e.entries(),[{key:"bar",value:"42"}]),e.set("bar","bar"),assert.deepEqual(e.entries(),[{key:"bar",value:"bar"}]),e.set("foo","foo"),assert.deepEqual(e.entries().sort(ascendingByKey),[{key:"bar",value:"bar"},{key:"foo",value:"foo"}]),e.remove("bar"),assert.deepEqual(e.entries(),[{key:"foo",value:"foo"}]),e.remove("foo"),assert.deepEqual(e.entries(),[]),e.remove("foo"),assert.deepEqual(e.entries(),[])}},keys:{"returns an array of string keys":function(){var e=d3.map({foo:1,bar:"42"});assert.deepEqual(e.keys().sort(),["bar","foo"])}},values:{"returns an array of arbitrary values":function(){var e=d3.map({foo:1,bar:"42"});assert.deepEqual(e.values().sort(),[1,"42"])}},entries:{"returns an array of key-value objects":function(){var e=d3.map({foo:1,bar:"42"});assert.deepEqual(e.entries().sort(ascendingByKey),[{key:"bar",value:"42"},{key:"foo",value:1}])}},has:{"empty maps do not have object built-ins":function(){var e=d3.map();assert.isFalse(e.has("__proto__")),assert.isFalse(e.has("hasOwnProperty"))},"can has keys using built-in names":function(){var e=d3.map();e.set("__proto__",42),assert.isTrue(e.has("__proto__"))},"can has keys with null or undefined properties":function(){var e=d3.map();e.set("",""),e.set("null",null),e.set("undefined",undefined),assert.isTrue(e.has("")),assert.isTrue(e.has("null")),assert.isTrue(e.has("undefined"))},"coerces keys to strings":function(){var e=d3.map({42:"foo","null":1,"undefined":2});assert.isTrue(e.has(42)),assert.isTrue(e.has(null)),assert.isTrue(e.has(undefined))},"returns the latest value":function(){var e=d3.map({foo:42});assert.isTrue(e.has("foo")),e.set("foo",43),assert.isTrue(e.has("foo")),e.remove("foo"),assert.isFalse(e.has("foo")),e.set("foo","bar"),assert.isTrue(e.has("foo"))},"returns undefined for missing keys":function(){var e=d3.map({foo:42});assert.isFalse(e.has("bar"))}},get:{"empty maps do not have object built-ins":function(){var e=d3.map();assert.isUndefined(e.get("__proto__")),assert.isUndefined(e.get("hasOwnProperty"))},"can get keys using built-in names":function(){var e=d3.map();e.set("__proto__",42),assert.equal(e.get("__proto__"),42)},"coerces keys to strings":function(){var e=d3.map({42:1,"null":2,"undefined":3});assert.equal(e.get(42),1),assert.equal(e.get(null),2),assert.equal(e.get(undefined),3)},"returns the latest value":function(){var e=d3.map({foo:42});assert.equal(e.get("foo"),42),e.set("foo",43),assert.equal(e.get("foo"),43),e.remove("foo"),assert.isUndefined(e.get("foo")),e.set("foo","bar"),assert.equal(e.get("foo"),"bar")},"returns undefined for missing keys":function(){var e=d3.map({foo:42});assert.isUndefined(e.get("bar"))}},set:{"returns the set value":function(){var e=d3.map();assert.equal(e.set("foo",42),42)},"can set keys using built-in names":function(){var e=d3.map();e.set("__proto__",42),assert.equal(e.get("__proto__"),42)},"coerces keys to strings":function(){var e=d3.map();e.set(42,1),assert.equal(e.get(42),1),e.set(null,2),assert.equal(e.get(null),2),e.set(undefined,3),assert.equal(e.get(undefined),3),assert.deepEqual(e.keys().sort(),["42","null","undefined"])},"can replace values":function(){var e=d3.map({foo:42});assert.equal(e.get("foo"),42),e.set("foo",43),assert.equal(e.get("foo"),43),e.set("foo","bar"),assert.equal(e.get("foo"),"bar")},"can set null, undefined or empty string values":function(){var e=d3.map();e.set("",""),e.set("null",null),e.set("undefined",undefined),assert.equal(e.get(""),""),assert.isNull(e.get("null")),assert.isUndefined(e.get("undefined"))}}}),suite.export(module)