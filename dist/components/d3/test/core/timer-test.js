function timer(e){var t=Array.prototype.slice.call(arguments);return function(){var e=this.callback,n={scheduled:Date.now(),count:0};t.unshift(function(){var t=++n.count;if(t===1)n.start=Date.now();else if(t===4)return n.stop=Date.now(),e(null,n),!0}),d3.timer.apply(this,t)}}require("../env");var vows=require("vows"),assert=require("assert"),suite=vows.describe("d3.timer");suite.addBatch({timer:{topic:function(){return d3.timer},"with no delay":{topic:timer(),"first calls after 17 ms or less":function(e){assert.inDelta(e.start-e.scheduled,17,20)},"calls until the function returns true":function(e){assert.equal(e.count,4)},"calls every 17 ms":function(e){assert.inDelta(e.stop-e.start,51,20)}},"with a specified delay":{topic:timer(250),"first calls after the delay":function(e){assert.inDelta(e.start-e.scheduled,250,20)},"calls until the function returns true":function(e){assert.equal(e.count,4)},"calls every 17 ms":function(e){assert.inDelta(e.stop-e.start,51,20)}}}}),suite.export(module)