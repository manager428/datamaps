(function(){function e(e,t){if(!e||!t||e.length!==t.length)return!1;var n=e.length,r=-1;while(++r<n)if(e[r]!==t[r])return!1;return!0}function t(t,n){var r=n.length;if(t>r)return null;var i=[],s=[],o={},u=0,a=0,f,l,c;while(a<t){if(u===r)return null;var h=Math.floor(Math.random()*r);if(h in o)continue;o[h]=1,u++,l=n[h],c=!0;for(f=0;f<a;f++)if(e(l,i[f])){c=!1;break}c&&(i[a]=l,s[a]=h,a++)}return i}function n(e,t,n,r){var i=[],s=e+n,o=t.length,u=-1;while(++u<o)i[u]=(e*t[u]+n*r[u])/s;return i}function r(e){var t=e.length,n=-1;while(++n<t)if(!isFinite(e[n]))return!1;return!0}function i(e){var t=e.length,n=0;while(++n<t)if(e[n-1]>=e[n])return!1;return!0}function s(e){return(e=1-e*e*e)*e*e}function o(e,t,n,r){var i=r[0],s=r[1],o=u(t,s);if(o<e.length&&e[o]-e[n]<e[n]-e[i]){var a=u(t,i);r[0]=a,r[1]=o}}function u(e,t){var n=t+1;while(n<e.length&&e[n]===0)n++;return n}science.stats={},science.stats.bandwidth={nrd0:function(e){var t=Math.sqrt(science.stats.variance(e));return(lo=Math.min(t,science.stats.iqr(e)/1.34))||(lo=t)||(lo=Math.abs(e[1]))||(lo=1),.9*lo*Math.pow(e.length,-0.2)},nrd:function(e){var t=science.stats.iqr(e)/1.34;return 1.06*Math.min(Math.sqrt(science.stats.variance(e)),t)*Math.pow(e.length,-0.2)}},science.stats.distance={euclidean:function(e,t){var n=e.length,r=-1,i=0,s;while(++r<n)s=e[r]-t[r],i+=s*s;return Math.sqrt(i)},manhattan:function(e,t){var n=e.length,r=-1,i=0;while(++r<n)i+=Math.abs(e[r]-t[r]);return i},minkowski:function(e){return function(t,n){var r=t.length,i=-1,s=0;while(++i<r)s+=Math.pow(Math.abs(t[i]-n[i]),e);return Math.pow(s,1/e)}},chebyshev:function(e,t){var n=e.length,r=-1,i=0,s;while(++r<n)s=Math.abs(e[r]-t[r]),s>i&&(i=s);return i},hamming:function(e,t){var n=e.length,r=-1,i=0;while(++r<n)e[r]!==t[r]&&i++;return i},jaccard:function(e,t){var n=e.length,r=-1,i=0;while(++r<n)e[r]===t[r]&&i++;return i/n},braycurtis:function(e,t){var n=e.length,r=-1,i=0,s=0,o,u;while(++r<n)o=e[r],u=t[r],i+=Math.abs(o-u),s+=Math.abs(o+u);return i/s}},science.stats.erf=function(e){var t=.254829592,n=-0.284496736,r=1.421413741,i=-1.453152027,s=1.061405429,o=.3275911,u=e<0?-1:1;e<0&&(u=-1,e=-e);var a=1/(1+o*e);return u*(1-((((s*a+i)*a+r)*a+n)*a+t)*a*Math.exp(-e*e))},science.stats.phi=function(e){return.5*(1+science.stats.erf(e/Math.SQRT2))},science.stats.kernel={uniform:function(e){return e<=1&&e>=-1?.5:0},triangular:function(e){return e<=1&&e>=-1?1-Math.abs(e):0},epanechnikov:function(e){return e<=1&&e>=-1?.75*(1-e*e):0},quartic:function(e){if(e<=1&&e>=-1){var t=1-e*e;return.9375*t*t}return 0},triweight:function(e){if(e<=1&&e>=-1){var t=1-e*e;return 35/32*t*t*t}return 0},gaussian:function(e){return 1/Math.sqrt(2*Math.PI)*Math.exp(-0.5*e*e)},cosine:function(e){return e<=1&&e>=-1?Math.PI/4*Math.cos(Math.PI/2*e):0}},science.stats.kde=function(){function r(r,i){var s=n.call(this,t);return r.map(function(n){var r=-1,i=0,o=t.length;while(++r<o)i+=e((n-t[r])/s);return[n,i/s/o]})}var e=science.stats.kernel.gaussian,t=[],n=science.stats.bandwidth.nrd;return r.kernel=function(t){return arguments.length?(e=t,r):e},r.sample=function(e){return arguments.length?(t=e,r):t},r.bandwidth=function(e){return arguments.length?(n=science.functor(e),r):n},r},science.stats.kmeans=function(){function s(s){var o=s.length,u=[],a=[],f=1,l=0,c=t(i,s),h,p,d,v,m,g,y;while(f&&l<r){d=-1;while(++d<i)a[d]=0;p=-1;while(++p<o){v=s[p],g=Infinity,d=-1;while(++d<i)m=n.call(this,c[d],v),m<g&&(g=m,y=d);a[u[p]=y]++}h=[],p=-1;while(++p<o){v=u[p],m=h[v];if(m==null)h[v]=s[p].slice();else{d=-1;while(++d<m.length)m[d]+=s[p][d]}}d=-1;while(++d<i){v=h[d],m=1/a[d],p=-1;while(++p<v.length)v[p]*=m}f=0,d=-1;while(++d<i)if(!e(h[d],c[d])){f=1;break}c=h,l++}return{assignments:u,centroids:c}}var n=science.stats.distance.euclidean,r=1e3,i=1;return s.k=function(e){return arguments.length?(i=e,s):i},s.distance=function(e){return arguments.length?(n=e,s):n},s},science.stats.hcluster=function(){function r(r){var i=r.length,s=[],o=[],u=[],a=[],f,l,c,h,p,d,v,m;v=-1;while(++v<i){s[v]=0,u[v]=[],m=-1;while(++m<i)u[v][m]=v===m?Infinity:e(r[v],r[m]),u[v][s[v]]>u[v][m]&&(s[v]=m)}v=-1;while(++v<i)a[v]=[],a[v][0]={left:null,right:null,dist:0,centroid:r[v],size:1,depth:0},o[v]=1;for(p=0;p<i-1;p++){f=0;for(v=0;v<i;v++)u[v][s[v]]<u[f][s[f]]&&(f=v);l=s[f],c=a[f][0],h=a[l][0],newCluster={left:c,right:h,dist:u[f][l],centroid:n(c.size,c.centroid,h.size,h.centroid),size:c.size+h.size,depth:1+Math.max(c.depth,h.depth)},a[f].splice(0,0,newCluster),o[f]+=o[l];for(m=0;m<i;m++)switch(t){case"single":u[f][m]>u[l][m]&&(u[m][f]=u[f][m]=u[l][m]);break;case"complete":u[f][m]<u[l][m]&&(u[m][f]=u[f][m]=u[l][m]);break;case"average":u[m][f]=u[f][m]=(o[f]*u[f][m]+o[l]*u[l][m])/(o[f]+o[m])}u[f][f]=Infinity;for(v=0;v<i;v++)u[v][l]=u[l][v]=Infinity;for(m=0;m<i;m++)s[m]==l&&(s[m]=f),u[f][m]<u[f][s[f]]&&(s[f]=m);d=newCluster}return d}var e=science.stats.distance.euclidean,t="simple";return r.distance=function(t){return arguments.length?(e=t,r):e},r},science.stats.iqr=function(e){var t=science.stats.quantiles(e,[.25,.75]);return t[1]-t[0]},science.stats.loess=function(){function u(u,a,f){var l=u.length,c;if(l!==a.length)throw{error:"Mismatched array lengths"};if(l==0)throw{error:"At least one point required."};if(arguments.length<3){f=[],c=-1;while(++c<l)f[c]=1}r(u),r(a),r(f),i(u);if(l==1)return[a[0]];if(l==2)return[a[0],a[1]];var h=Math.floor(e*l);if(h<2)throw{error:"Bandwidth too small."};var p=[],d=[],v=[];c=-1;while(++c<l)p[c]=0,d[c]=0,v[c]=1;var m=-1;while(++m<=t){var g=[0,h-1],y;c=-1;while(++c<l){y=u[c],c>0&&o(u,f,c,g);var b=g[0],w=g[1],E=u[c]-u[b]>u[w]-u[c]?b:w,S=0,x=0,T=0,N=0,C=0,k=Math.abs(1/(u[E]-y));for(var L=b;L<=w;++L){var A=u[L],O=a[L],M=L<c?y-A:A-y,_=s(M*k)*v[L]*f[L],D=A*_;S+=_,x+=D,T+=A*D,N+=O*_,C+=O*D}var P=x/S,H=N/S,B=C/S,j=T/S,F=Math.sqrt(Math.abs(j-P*P))<n?0:(B-P*H)/(j-P*P),I=H-F*P;p[c]=F*y+I,d[c]=Math.abs(a[c]-p[c])}if(m===t)break;var q=d.slice();q.sort();var R=q[Math.floor(l/2)];if(Math.abs(R)<n)break;var U,_;c=-1;while(++c<l)U=d[c]/(6*R),v[c]=U>=1?0:(_=1-U*U)*_}return p}var e=.3,t=2,n=1e-12;return u.bandwidth=function(t){return arguments.length?(e=t,u):t},u.robustnessIterations=function(e){return arguments.length?(t=e,u):e},u.accuracy=function(e){return arguments.length?(n=e,u):e},u},science.stats.mean=function(e){var t=e.length;if(t===0)return NaN;var n=0,r=-1;while(++r<t)n+=(e[r]-n)/(r+1);return n},science.stats.median=function(e){return science.stats.quantiles(e,[.5])[0]},science.stats.mode=function(e){e=e.slice().sort(science.ascending);var t,n=e.length,r=-1,i=r,s=null,o=0,u,a;while(++r<n)(a=e[r])!==s&&((u=r-i)>o&&(o=u,t=s),s=a,i=r);return t},science.stats.quantiles=function(e,t){e=e.slice().sort(science.ascending);var n=e.length-1;return t.map(function(t){if(t===0)return e[0];if(t===1)return e[n];var r=1+t*n,i=Math.floor(r),s=r-i,o=e[i-1];return s===0?o:o+s*(e[i]-o)})},science.stats.variance=function(e){var t=e.length;if(t<1)return NaN;if(t===1)return 0;var n=science.stats.mean(e),r=-1,i=0;while(++r<t){var s=e[r]-n;i+=s*s}return i/(t-1)}})()