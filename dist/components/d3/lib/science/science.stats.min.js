(function(){function e(e,t){var n=t+1;while(n<e.length&&e[n]===0)n++;return n}function t(t,n,r,i){var s=i[0],o=i[1],u=e(n,o);if(u<t.length&&t[u]-t[r]<t[r]-t[s]){var a=e(n,s);i[0]=a,i[1]=u}}function n(e){return(e=1-e*e*e)*e*e}function r(e){var t=e.length,n=0;while(++n<t)if(e[n-1]>=e[n])return!1;return!0}function i(e){var t=e.length,n=-1;while(++n<t)if(!isFinite(e[n]))return!1;return!0}function s(e,t,n,r){var i=[],s=e+n,o=t.length,u=-1;while(++u<o)i[u]=(e*t[u]+n*r[u])/s;return i}function o(e,t){var n=t.length;if(e>n)return null;var r=[],i=[],s={},o=0,f=0,l,c,h;while(f<e){if(o===n)return null;var p=Math.floor(Math.random()*n);if(p in s)continue;s[p]=1,o++,c=t[p],h=!0;for(l=0;l<f;l++)if(u(c,r[l])){h=!1;break}h&&(r[f]=c,i[f]=p,f++)}return r}function u(e,t){if(!e||!t||e.length!==t.length)return!1;var n=e.length,r=-1;while(++r<n)if(e[r]!==t[r])return!1;return!0}science.stats={},science.stats.bandwidth={nrd0:function(e){var t=Math.sqrt(science.stats.variance(e));return(lo=Math.min(t,science.stats.iqr(e)/1.34))||(lo=t)||(lo=Math.abs(e[1]))||(lo=1),.9*lo*Math.pow(e.length,-0.2)},nrd:function(e){var t=science.stats.iqr(e)/1.34;return 1.06*Math.min(Math.sqrt(science.stats.variance(e)),t)*Math.pow(e.length,-0.2)}},science.stats.distance={euclidean:function(e,t){var n=e.length,r=-1,i=0,s;while(++r<n)s=e[r]-t[r],i+=s*s;return Math.sqrt(i)},manhattan:function(e,t){var n=e.length,r=-1,i=0;while(++r<n)i+=Math.abs(e[r]-t[r]);return i},minkowski:function(e){return function(t,n){var r=t.length,i=-1,s=0;while(++i<r)s+=Math.pow(Math.abs(t[i]-n[i]),e);return Math.pow(s,1/e)}},chebyshev:function(e,t){var n=e.length,r=-1,i=0,s;while(++r<n)s=Math.abs(e[r]-t[r]),s>i&&(i=s);return i},hamming:function(e,t){var n=e.length,r=-1,i=0;while(++r<n)e[r]!==t[r]&&i++;return i},jaccard:function(e,t){var n=e.length,r=-1,i=0;while(++r<n)e[r]===t[r]&&i++;return i/n},braycurtis:function(e,t){var n=e.length,r=-1,i=0,s=0,o,u;while(++r<n)o=e[r],u=t[r],i+=Math.abs(o-u),s+=Math.abs(o+u);return i/s}},science.stats.erf=function(e){var t=.254829592,n=-0.284496736,r=1.421413741,i=-1.453152027,s=1.061405429,o=.3275911,u=e<0?-1:1;e<0&&(u=-1,e=-e);var a=1/(1+o*e);return u*(1-((((s*a+i)*a+r)*a+n)*a+t)*a*Math.exp(-e*e))},science.stats.phi=function(e){return.5*(1+science.stats.erf(e/Math.SQRT2))},science.stats.kernel={uniform:function(e){return e<=1&&e>=-1?.5:0},triangular:function(e){return e<=1&&e>=-1?1-Math.abs(e):0},epanechnikov:function(e){return e<=1&&e>=-1?.75*(1-e*e):0},quartic:function(e){if(e<=1&&e>=-1){var t=1-e*e;return.9375*t*t}return 0},triweight:function(e){if(e<=1&&e>=-1){var t=1-e*e;return 35/32*t*t*t}return 0},gaussian:function(e){return 1/Math.sqrt(2*Math.PI)*Math.exp(-0.5*e*e)},cosine:function(e){return e<=1&&e>=-1?Math.PI/4*Math.cos(Math.PI/2*e):0}},science.stats.kde=function(){function e(e,i){var s=r.call(this,n);return e.map(function(e){var r=-1,i=0,o=n.length;while(++r<o)i+=t((e-n[r])/s);return[e,i/s/o]})}var t=science.stats.kernel.gaussian,n=[],r=science.stats.bandwidth.nrd;return e.kernel=function(n){return arguments.length?(t=n,e):t},e.sample=function(t){return arguments.length?(n=t,e):n},e.bandwidth=function(t){return arguments.length?(r=science.functor(t),e):r},e},science.stats.kmeans=function(){function e(e){var i=e.length,s=[],f=[],l=1,h=0,p=o(r,e),v,m,g,y,w,E,S;while(l&&h<n){g=-1;while(++g<r)f[g]=0;m=-1;while(++m<i){y=e[m],E=Infinity,g=-1;while(++g<r)w=t.call(this,p[g],y),w<E&&(E=w,S=g);f[s[m]=S]++}v=[],m=-1;while(++m<i){y=s[m],w=v[y];if(w==null)v[y]=e[m].slice();else{g=-1;while(++g<w.length)w[g]+=e[m][g]}}g=-1;while(++g<r){y=v[g],w=1/f[g],m=-1;while(++m<y.length)y[m]*=w}l=0,g=-1;while(++g<r)if(!u(v[g],p[g])){l=1;break}p=v,h++}return{assignments:s,centroids:p}}var t=science.stats.distance.euclidean,n=1e3,r=1;return e.k=function(t){return arguments.length?(r=t,e):r},e.distance=function(n){return arguments.length?(t=n,e):t},e},science.stats.hcluster=function(){function e(e){var r=e.length,i=[],o=[],u=[],f=[],l,h,p,d,v,m,g,y;g=-1;while(++g<r){i[g]=0,u[g]=[],y=-1;while(++y<r)u[g][y]=g===y?Infinity:t(e[g],e[y]),u[g][i[g]]>u[g][y]&&(i[g]=y)}g=-1;while(++g<r)f[g]=[],f[g][0]={left:null,right:null,dist:0,centroid:e[g],size:1,depth:0},o[g]=1;for(v=0;v<r-1;v++){l=0;for(g=0;g<r;g++)u[g][i[g]]<u[l][i[l]]&&(l=g);h=i[l],p=f[l][0],d=f[h][0],newCluster={left:p,right:d,dist:u[l][h],centroid:s(p.size,p.centroid,d.size,d.centroid),size:p.size+d.size,depth:1+Math.max(p.depth,d.depth)},f[l].splice(0,0,newCluster),o[l]+=o[h];for(y=0;y<r;y++)switch(n){case"single":u[l][y]>u[h][y]&&(u[y][l]=u[l][y]=u[h][y]);break;case"complete":u[l][y]<u[h][y]&&(u[y][l]=u[l][y]=u[h][y]);break;case"average":u[y][l]=u[l][y]=(o[l]*u[l][y]+o[h]*u[h][y])/(o[l]+o[y])}u[l][l]=Infinity;for(g=0;g<r;g++)u[g][h]=u[h][g]=Infinity;for(y=0;y<r;y++)i[y]==h&&(i[y]=l),u[l][y]<u[l][i[l]]&&(i[l]=y);m=newCluster}return m}var t=science.stats.distance.euclidean,n="simple";return e.distance=function(n){return arguments.length?(t=n,e):t},e},science.stats.iqr=function(e){var t=science.stats.quantiles(e,[.25,.75]);return t[1]-t[0]},science.stats.loess=function(){function e(e,l,h){var p=e.length,v;if(p!==l.length)throw{error:"Mismatched array lengths"};if(p==0)throw{error:"At least one point required."};if(arguments.length<3){h=[],v=-1;while(++v<p)h[v]=1}i(e),i(l),i(h),r(e);if(p==1)return[l[0]];if(p==2)return[l[0],l[1]];var m=Math.floor(s*p);if(m<2)throw{error:"Bandwidth too small."};var y=[],w=[],E=[];v=-1;while(++v<p)y[v]=0,w[v]=0,E[v]=1;var S=-1;while(++S<=o){var x=[0,m-1],T;v=-1;while(++v<p){T=e[v],v>0&&t(e,h,v,x);var N=x[0],C=x[1],k=e[v]-e[N]>e[C]-e[v]?N:C,L=0,A=0,O=0,M=0,_=0,D=Math.abs(1/(e[k]-T));for(var P=N;P<=C;++P){var H=e[P],B=l[P],j=P<v?T-H:H-T,F=n(j*D)*E[P]*h[P],I=H*F;L+=F,A+=I,O+=H*I,M+=B*F,_+=B*I}var q=A/L,R=M/L,U=_/L,z=O/L,W=Math.sqrt(Math.abs(z-q*q))<u?0:(U-q*R)/(z-q*q),X=R-W*q;y[v]=W*T+X,w[v]=Math.abs(l[v]-y[v])}if(S===o)break;var V=w.slice();V.sort();var $=V[Math.floor(p/2)];if(Math.abs($)<u)break;var J,F;v=-1;while(++v<p)J=w[v]/(6*$),E[v]=J>=1?0:(F=1-J*J)*F}return y}var s=.3,o=2,u=1e-12;return e.bandwidth=function(t){return arguments.length?(s=t,e):t},e.robustnessIterations=function(t){return arguments.length?(o=t,e):t},e.accuracy=function(t){return arguments.length?(u=t,e):t},e},science.stats.mean=function(e){var t=e.length;if(t===0)return NaN;var n=0,r=-1;while(++r<t)n+=(e[r]-n)/(r+1);return n},science.stats.median=function(e){return science.stats.quantiles(e,[.5])[0]},science.stats.mode=function(e){e=e.slice().sort(science.ascending);var t,n=e.length,r=-1,i=r,s=null,o=0,u,a;while(++r<n)(a=e[r])!==s&&((u=r-i)>o&&(o=u,t=s),s=a,i=r);return t},science.stats.quantiles=function(e,t){e=e.slice().sort(science.ascending);var n=e.length-1;return t.map(function(t){if(t===0)return e[0];if(t===1)return e[n];var r=1+t*n,i=Math.floor(r),s=r-i,o=e[i-1];return s===0?o:o+s*(e[i]-o)})},science.stats.variance=function(e){var t=e.length;if(t<1)return NaN;if(t===1)return 0;var n=science.stats.mean(e),r=-1,i=0;while(++r<t){var s=e[r]-n;i+=s*s}return i/(t-1)}})()