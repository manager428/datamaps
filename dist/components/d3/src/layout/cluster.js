function d3_layout_clusterY(e){return 1+d3.max(e,function(e){return e.y})}function d3_layout_clusterX(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function d3_layout_clusterLeft(e){var t=e.children;return t&&t.length?d3_layout_clusterLeft(t[0]):e}function d3_layout_clusterRight(e){var t=e.children,n;return t&&(n=t.length)?d3_layout_clusterRight(t[n-1]):e}d3.layout.cluster=function(){function r(r,i){var s=e.call(this,r,i),o=s[0],u,a=0,f,l;d3_layout_treeVisitAfter(o,function(e){var n=e.children;n&&n.length?(e.x=d3_layout_clusterX(n),e.y=d3_layout_clusterY(n)):(e.x=u?a+=t(e,u):0,e.y=0,u=e)});var c=d3_layout_clusterLeft(o),h=d3_layout_clusterRight(o),p=c.x-t(c,h)/2,d=h.x+t(h,c)/2;return d3_layout_treeVisitAfter(o,function(e){e.x=(e.x-p)/(d-p)*n[0],e.y=(1-(o.y?e.y/o.y:1))*n[1]}),s}var e=d3.layout.hierarchy().sort(null).value(null),t=d3_layout_treeSeparation,n=[1,1];return r.separation=function(e){return arguments.length?(t=e,r):t},r.size=function(e){return arguments.length?(n=e,r):n},d3_layout_hierarchyRebind(r,e)}