function d3_layout_forceDragstart(e){e.fixed|=2}function d3_layout_forceDragend(e){e.fixed&=1}function d3_layout_forceMouseover(e){e.fixed|=4}function d3_layout_forceMouseout(e){e.fixed&=3}function d3_layout_forceAccumulate(e,t,n){var r=0,i=0;e.charge=0;if(!e.leaf){var s=e.nodes,o=s.length,u=-1,a;while(++u<o){a=s[u];if(a==null)continue;d3_layout_forceAccumulate(a,t,n),e.charge+=a.charge,r+=a.charge*a.cx,i+=a.charge*a.cy}}if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var f=t*n[e.point.index];e.charge+=e.pointCharge=f,r+=f*e.point.x,i+=f*e.point.y}e.cx=r/e.charge,e.cy=i/e.charge}function d3_layout_forceLinkDistance(e){return 20}function d3_layout_forceLinkStrength(e){return 1}d3.layout.force=function(){function g(e){return function(t,n,r,i,s){if(t.point!==e){var o=t.cx-e.x,u=t.cy-e.y,a=1/Math.sqrt(o*o+u*u);if((i-n)*a<l){var f=t.charge*a*a;return e.px-=o*f,e.py-=u*f,!0}if(t.point&&isFinite(a)){var f=t.pointCharge*a*a;e.px-=o*f,e.py-=u*f}}return!t.charge}}function y(t){t.px=d3.event.x,t.py=d3.event.y,e.resume()}var e={},t=d3.dispatch("start","tick","end"),n=[1,1],r,i,s=.9,o=d3_layout_forceLinkDistance,u=d3_layout_forceLinkStrength,a=-30,f=.1,l=.8,c,h=[],p=[],d,v,m;return e.tick=function(){if((i*=.99)<.005)return t.end({type:"end",alpha:i=0}),!0;var e=h.length,r=p.length,o,u,l,c,y,b,w,E,S;for(u=0;u<r;++u){l=p[u],c=l.source,y=l.target,E=y.x-c.x,S=y.y-c.y;if(b=E*E+S*S)b=i*v[u]*((b=Math.sqrt(b))-d[u])/b,E*=b,S*=b,y.x-=E*(w=c.weight/(y.weight+c.weight)),y.y-=S*w,c.x+=E*(w=1-w),c.y+=S*w}if(w=i*f){E=n[0]/2,S=n[1]/2,u=-1;if(w)while(++u<e)l=h[u],l.x+=(E-l.x)*w,l.y+=(S-l.y)*w}if(a){d3_layout_forceAccumulate(o=d3.geom.quadtree(h),i,m),u=-1;while(++u<e)(l=h[u]).fixed||o.visit(g(l))}u=-1;while(++u<e)l=h[u],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*s,l.y-=(l.py-(l.py=l.y))*s);t.tick({type:"tick",alpha:i})},e.nodes=function(t){return arguments.length?(h=t,e):h},e.links=function(t){return arguments.length?(p=t,e):p},e.size=function(t){return arguments.length?(n=t,e):n},e.linkDistance=function(t){return arguments.length?(o=d3_functor(t),e):o},e.distance=e.linkDistance,e.linkStrength=function(t){return arguments.length?(u=d3_functor(t),e):u},e.friction=function(t){return arguments.length?(s=t,e):s},e.charge=function(t){return arguments.length?(a=typeof t=="function"?t:+t,e):a},e.gravity=function(t){return arguments.length?(f=t,e):f},e.theta=function(t){return arguments.length?(l=t,e):l},e.alpha=function(n){return arguments.length?(i?n>0?i=n:i=0:n>0&&(t.start({type:"start",alpha:i=n}),d3.timer(e.tick)),e):i},e.start=function(){function y(e,n){var r=b(t),i=-1,s=r.length,o;while(++i<s)if(!isNaN(o=r[i][e]))return o;return Math.random()*n}function b(){if(!c){c=[];for(r=0;r<i;++r)c[r]=[];for(r=0;r<s;++r){var e=p[r];c[e.source.index].push(e.target),c[e.target.index].push(e.source)}}return c[t]}var t,r,i=h.length,s=p.length,f=n[0],l=n[1],c,g;for(t=0;t<i;++t)(g=h[t]).index=t,g.weight=0;d=[],v=[];for(t=0;t<s;++t)g=p[t],typeof g.source=="number"&&(g.source=h[g.source]),typeof g.target=="number"&&(g.target=h[g.target]),d[t]=o.call(this,g,t),v[t]=u.call(this,g,t),++g.source.weight,++g.target.weight;for(t=0;t<i;++t)g=h[t],isNaN(g.x)&&(g.x=y("x",f)),isNaN(g.y)&&(g.y=y("y",l)),isNaN(g.px)&&(g.px=g.x),isNaN(g.py)&&(g.py=g.y);m=[];if(typeof a=="function")for(t=0;t<i;++t)m[t]=+a.call(this,h[t],t);else for(t=0;t<i;++t)m[t]=a;return e.resume()},e.resume=function(){return e.alpha(.1)},e.stop=function(){return e.alpha(0)},e.drag=function(){r||(r=d3.behavior.drag().origin(d3_identity).on("dragstart",d3_layout_forceDragstart).on("drag",y).on("dragend",d3_layout_forceDragend)),this.on("mouseover.force",d3_layout_forceMouseover).on("mouseout.force",d3_layout_forceMouseout).call(r)},d3.rebind(e,t,"on")}