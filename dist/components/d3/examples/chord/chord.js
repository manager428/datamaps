function groupTicks(e){var t=(e.endAngle-e.startAngle)/e.value;return d3.range(0,e.value,1e3).map(function(n,r){return{angle:n*t+e.startAngle,label:r%5?null:n/1e3+"k"}})}function fade(e){return function(t,n){svg.selectAll("g.chord path").filter(function(e){return e.source.index!=n&&e.target.index!=n}).transition().style("opacity",e)}}var chord=d3.layout.chord().padding(.05).sortSubgroups(d3.descending).matrix([[11975,5871,8916,2868],[1951,10048,2060,6171],[8010,16145,8090,8045],[1013,990,940,6907]]),width=600,height=600,innerRadius=Math.min(width,height)*.41,outerRadius=innerRadius*1.1,fill=d3.scale.ordinal().domain(d3.range(4)).range(["#000000","#FFDD89","#957244","#F26223"]),svg=d3.select("#chart").append("svg").attr("width",width).attr("height",height).append("g").attr("transform","translate("+width/2+","+height/2+")");svg.append("g").selectAll("path").data(chord.groups).enter().append("path").style("fill",function(e){return fill(e.index)}).style("stroke",function(e){return fill(e.index)}).attr("d",d3.svg.arc().innerRadius(innerRadius).outerRadius(outerRadius)).on("mouseover",fade(.1)).on("mouseout",fade(1));var ticks=svg.append("g").selectAll("g").data(chord.groups).enter().append("g").selectAll("g").data(groupTicks).enter().append("g").attr("transform",function(e){return"rotate("+(e.angle*180/Math.PI-90)+")"+"translate("+outerRadius+",0)"});ticks.append("line").attr("x1",1).attr("y1",0).attr("x2",5).attr("y2",0).style("stroke","#000"),ticks.append("text").attr("x",8).attr("dy",".35em").attr("text-anchor",function(e){return e.angle>Math.PI?"end":null}).attr("transform",function(e){return e.angle>Math.PI?"rotate(180)translate(-16)":null}).text(function(e){return e.label}),svg.append("g").attr("class","chord").selectAll("path").data(chord.chords).enter().append("path").style("fill",function(e){return fill(e.target.index)}).attr("d",d3.svg.chord().radius(innerRadius)).style("opacity",1)