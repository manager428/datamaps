var data=[,.187,.198,,.133,.175,.151,,.1,.125,.171,,.172,.133,,.108,.142,.167,.201,.175,.159,.169,.177,.141,.163,.117,.182,.153,.195,.189,.134,.163,.133,.151,.145,.13,.139,.169,.164,.175,.135,.152,.169,,.132,.167,.139,.184,.159,.14,.146,.157,,.139,.183,.16,.143],color=d3.scale.linear().domain([d3.min(data),d3.max(data)]).range(["#aad","#556"]),force=d3.layout.force().charge(0).gravity(0).size([960,500]),svg=d3.select("#chart").append("svg");d3.json("../data/us-state-centroids.json",function(e){var t=d3.geo.albersUsa(),n={},r=[],i=e.features.map(function(e){var r=t(e.geometry.coordinates);return n[e.id]={x:r[0],y:r[1],gravity:{x:r[0],y:r[1]},r:Math.sqrt(data[+e.id]*2500),value:data[+e.id]}});force.nodes(i).links(r).start().on("tick",function(e){var t=e.alpha*.5,n=t*.1;i.forEach(function(e,r){e.x+=(e.gravity.x-e.x)*n,e.y+=(e.gravity.y-e.y)*n,i.slice(r+1).forEach(function(n){var r=e.x-n.x,i=e.y-n.y,s=e.r+n.r,o=Math.abs(r),u=Math.abs(i);o<s&&u<s&&(o=(o-s)/o*t,u=(u-s)/u*t,r*=o,i*=u,e.x-=r,e.y-=i,n.x+=r,n.y+=i)})}),svg.selectAll("rect").attr("x",function(e){return e.x-e.r}).attr("y",function(e){return e.y-e.r})}),svg.selectAll("rect").data(i).enter().append("rect").style("fill",function(e){return color(e.value)}).attr("x",function(e){return e.x-e.r}).attr("y",function(e){return e.y-e.r}).attr("width",function(e){return e.r*2}).attr("height",function(e){return e.r*2})})