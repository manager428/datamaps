function classes(e){function n(e,r){r.children?r.children.forEach(function(e){n(r.name,e)}):t.push({packageName:e,className:r.name,value:r.size})}var t=[];return n(null,e),{children:t}}var r=960,format=d3.format(",d"),fill=d3.scale.category20c(),bubble=d3.layout.pack().sort(null).size([r,r]).padding(1.5),vis=d3.select("#chart").append("svg").attr("width",r).attr("height",r).attr("class","bubble");d3.json("../data/flare.json",function(e){var t=vis.selectAll("g.node").data(bubble.nodes(classes(e)).filter(function(e){return!e.children})).enter().append("g").attr("class","node").attr("transform",function(e){return"translate("+e.x+","+e.y+")"});t.append("title").text(function(e){return e.className+": "+format(e.value)}),t.append("circle").attr("r",function(e){return e.r}).style("fill",function(e){return fill(e.packageName)}),t.append("text").attr("text-anchor","middle").attr("dy",".3em").text(function(e){return e.className.substring(0,e.r/3)})})